import numpy as np
from numpy import sin, cos
import sys
from model_base import *

#----------------------------
# Dynamics
#----------------------------

m0 = 0.3
m1 = 0.5
m2 = 0.4
g  = 9.8
epsilon = 0.000001

def f_air_3mass(t, s, u, params={}):

    th0 = s[IDX_th0]
    th1 = s[IDX_th1]
    th2 = s[IDX_th2]
    dth0 = s[IDX_dth0]
    dth1 = s[IDX_dth1]
    dth2 = s[IDX_dth2]
    tau0 = 0
    tau1 = u[0]
    tau2 = u[1]

    detA = (36*cos(2*th2+2*th1)-132*cos(2*th2)-117*cos(2*th1)+213)/6.4E+5
    assert detA > epsilon, detA
    rdetA = 1.0 / detA

    dd0 = rdetA * (-((((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0))*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2-2400*dth2**2+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0))*cos(th1))*sin(2*th1)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3)*cos(th1))*cos(2*th1)+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**3+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)**3+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3)*cos(th1)*sin(th1)**2+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**3+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**2*sin(th1)+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3)*cos(th1)**3)*sin(th2)+(((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2-2400*dth2**2+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0))*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0))*cos(th1))*sin(2*th1)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3)*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0))*cos(th1))*cos(2*th1))*cos(th2)+((((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)**3+((7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*sin(th0))*sin(th1)+(((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0)+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0))*cos(th1)+(70560-6300*dth0**2*sin(th0))*sin(2*th0)-6300*dth0**2*cos(th0)*cos(2*th0)+((-123480*cos(th0))-12000*tau1)*sin(th0)+12600*dth0**2*cos(th0))*sin(2*th1)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th0)**2+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**3)*sin(th1)+(((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0))*cos(th1)-6300*dth0**2*cos(th0)*sin(2*th0)+(6300*dth0**2*sin(th0)-70560)*cos(2*th0)+123480*cos(th0)**2+12000*tau1*cos(th0))*cos(2*th1)+((-17160*dth0**2*sin(th0)**3)+168168*sin(th0)**2-17160*dth0**2*cos(th0)**2*sin(th0))*sin(th1)**2+(((-7800*dth0**2*cos(th0)*sin(th0)**2)-91728*cos(th0)*sin(th0)-7800*dth0**2*cos(th0)**3)*cos(th1)+(26400*tau1-26400*tau2)*sin(th0))*sin(th1)-76440*cos(th0)**2*cos(th1)**2+(12000*tau1-12000*tau2)*cos(th0)*cos(th1))*sin(2*th2)+(((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3)*cos(th1))*sin(2*th1)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+(((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2+2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0))*cos(th1))*cos(2*th1)+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3)*sin(th1)**3+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**3+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)*sin(th1)**2+(((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3)*cos(th1)**2+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*cos(th0)*cos(2*th0))*sin(th1)+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**3+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**3+(((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*cos(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*cos(2*th0)+(28160*dth2**2+(56320*dth1+56320*dth0)*dth2+28160*dth1**2+56320*dth0*dth1+28160*dth0**2)*sin(th0)**3+(28160*dth2**2+(56320*dth1+56320*dth0)*dth2+28160*dth1**2+56320*dth0*dth1+28160*dth0**2)*cos(th0)**2*sin(th0))*cos(th1))*sin(th2)+((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3)*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0))*cos(th1))*sin(2*th1)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+(((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2+2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0))*cos(th1))*cos(2*th1)+(((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*cos(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*cos(2*th0)+(28160*dth2**2+(56320*dth1+56320*dth0)*dth2+28160*dth1**2+56320*dth0*dth1+28160*dth0**2)*sin(th0)**3+(28160*dth2**2+(56320*dth1+56320*dth0)*dth2+28160*dth1**2+56320*dth0*dth1+28160*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+(((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*sin(th0)*sin(2*th0)+((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*cos(th0)*cos(2*th0))*cos(th1))*cos(th2)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th0)**2+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**3)*sin(th1)+(((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0))*cos(th1)-6300*dth0**2*cos(th0)*sin(2*th0)+(6300*dth0**2*sin(th0)-70560)*cos(2*th0)+123480*cos(th0)**2+12000*tau1*cos(th0))*sin(2*th1)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*sin(th0)**3+(((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0))*sin(th1)+((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0))*cos(th1)+(6300*dth0**2*sin(th0)-70560)*sin(2*th0)+6300*dth0**2*cos(th0)*cos(2*th0)+(123480*cos(th0)+12000*tau1)*sin(th0)-12600*dth0**2*cos(th0))*cos(2*th1)+((-7800*dth0**2*cos(th0)*sin(th0)**2)+76440*cos(th0)*sin(th0)-7800*dth0**2*cos(th0)**3)*sin(th1)**2+((17160*dth0**2*sin(th0)**3-168168*sin(th0)**2+17160*dth0**2*cos(th0)**2*sin(th0)-76440*cos(th0)**2)*cos(th1)+((-33280*dth1**2)-66560*dth0*dth1-33280*dth0**2)*cos(th0)*sin(2*th0)+(33280*dth1**2+66560*dth0*dth1+33280*dth0**2)*sin(th0)*cos(2*th0)+(91520*dth1**2+183040*dth0*dth1+91520*dth0**2)*sin(th0)**3+(91520*dth1**2+183040*dth0*dth1+91520*dth0**2)*cos(th0)**2*sin(th0)+(12000*tau1-12000*tau2)*cos(th0))*sin(th1)+168168*cos(th0)*sin(th0)*cos(th1)**2+(((-33280*dth1**2)-66560*dth0*dth1-33280*dth0**2)*sin(th0)*sin(2*th0)+((-33280*dth1**2)-66560*dth0*dth1-33280*dth0**2)*cos(th0)*cos(2*th0)+(26400*tau2-26400*tau1)*sin(th0))*cos(th1)+(602112-53760*dth0**2*sin(th0))*sin(2*th0)-53760*dth0**2*cos(th0)*cos(2*th0)+((-1448832*cos(th0))-140800*tau1)*sin(th0))*cos(2*th2)+((12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*cos(th0)*sin(th1)+(12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*sin(th0)*cos(th1))*sin(th2)**3+(((12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*sin(th0)*sin(th1)+((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*cos(th0)*cos(th1))*cos(th2)+((19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*sin(th0)**3+(19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)**3+(((4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)*sin(th0)**2+(4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)**3)*cos(th1)-195216*cos(th0)*sin(th0))*sin(th1)**2+(((19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*sin(th0)**3+(19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**2+(19920*dth0**2*sin(th0)**3-195216*sin(th0)**2+19920*dth0**2*cos(th0)**2*sin(th0)-47040*cos(th0)**2)*cos(th1)+(41080*dth1**2+82160*dth0*dth1+41080*dth0**2)*sin(th0))*sin(th1)+((4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)*sin(th0)**2+(4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)**3)*cos(th1)**3+(4800*dth0**2*cos(th0)*sin(th0)**2-47040*cos(th0)*sin(th0)+4800*dth0**2*cos(th0)**3)*cos(th1)**2+((-41080*dth1**2)-82160*dth0*dth1-41080*dth0**2)*cos(th0)*cos(th1)-66360*dth0**2*cos(th0))*sin(th2)**2+((((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*cos(th0)*sin(th1)+((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*sin(th0)*cos(th1))*cos(th2)**2+((((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)*sin(th0)**2+((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)**3)*sin(th1)**3+(((14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*sin(th0)**3+(14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)+19920*dth0**2*sin(th0)**3-195216*sin(th0)**2+19920*dth0**2*cos(th0)**2*sin(th0)+105840*cos(th0)**2)*sin(th1)**2+((((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)*sin(th0)**2+((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)**3)*cos(th1)**2+((-6000*dth0**2*cos(th0)*sin(th0)**2)+112896*cos(th0)*sin(th0)-6000*dth0**2*cos(th0)**3)*cos(th1))*sin(th1)+((14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*sin(th0)**3+(14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**3+(14400*dth0**2*sin(th0)**3-141120*sin(th0)**2+14400*dth0**2*cos(th0)**2*sin(th0)+47040*cos(th0)**2)*cos(th1)**2)*cos(th2)+((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0))*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)*sin(th0)**2+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**3)*cos(th1))*sin(2*th1)+(((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0))*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**2*sin(th0))*cos(th1))*cos(2*th1)+(((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)*sin(th0)**2+((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0))*sin(th1)**3+((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*sin(th0)**3+((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*cos(th0)**2+7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0))*cos(th1)*sin(th1)**2+((((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)*sin(th0)**2+((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)**3+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0))*cos(th1)**2+((-16540*dth2**2)+((-33080*dth1)-33080*dth0)*dth2-16540*dth1**2-33080*dth0*dth1-16540*dth0**2)*cos(th0)*sin(th0)**2-99600*tau2*sin(th0)+((-16540*dth2**2)+((-33080*dth1)-33080*dth0)*dth2-16540*dth1**2-33080*dth0*dth1-16540*dth0**2)*cos(th0)**3+(21640*dth2**2+(43280*dth1+43280*dth0)*dth2+21640*dth1**2+43280*dth0*dth1+21640*dth0**2)*cos(th0))*sin(th1)+((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*sin(th0)**3+((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*cos(th0)**2-7800*dth2**2+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*sin(th0))*cos(th1)**3+(((-31420*dth2**2)+((-62840*dth1)-62840*dth0)*dth2-31420*dth1**2-62840*dth0*dth1-31420*dth0**2)*sin(th0)**3+(((-31420*dth2**2)+((-62840*dth1)-62840*dth0)*dth2-31420*dth1**2-62840*dth0*dth1-31420*dth0**2)*cos(th0)**2+21640*dth2**2+(43280*dth1+43280*dth0)*dth2+21640*dth1**2+43280*dth0*dth1+21640*dth0**2)*sin(th0)-24000*tau2*cos(th0))*cos(th1))*sin(th2)+(((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*sin(th0)*sin(th1)+(12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*cos(th0)*cos(th1))*cos(th2)**3+(((-10800*dth0**2*cos(th0)*sin(th0)**2)+105840*cos(th0)*sin(th0)-10800*dth0**2*cos(th0)**3)*sin(th1)**2+((14400*dth0**2*sin(th0)**3-141120*sin(th0)**2+14400*dth0**2*cos(th0)**2*sin(th0)-105840*cos(th0)**2)*cos(th1)+((-41080*dth1**2)-82160*dth0*dth1-41080*dth0**2)*sin(th0))*sin(th1)+141120*cos(th0)*sin(th0)*cos(th1)**2+(41080*dth1**2+82160*dth0*dth1+41080*dth0**2)*cos(th0)*cos(th1)+66360*dth0**2*cos(th0))*cos(th2)**2+(((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)*sin(th0)**2+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**3)*sin(th1)+((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0))*cos(th1))*sin(2*th1)+((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0))*cos(th1))*cos(2*th1)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)*sin(th1)**3+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)*cos(th1)*sin(th1)**2+(((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*sin(th0)*cos(th1)**2+((-31420*dth2**2)+((-62840*dth1)-62840*dth0)*dth2-31420*dth1**2-62840*dth0*dth1-31420*dth0**2)*sin(th0)**3+(((-31420*dth2**2)+((-62840*dth1)-62840*dth0)*dth2-31420*dth1**2-62840*dth0*dth1-31420*dth0**2)*cos(th0)**2+21640*dth2**2+(43280*dth1+43280*dth0)*dth2+21640*dth1**2+43280*dth0*dth1+21640*dth0**2)*sin(th0)+54000*tau2*cos(th0))*sin(th1)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)*cos(th1)**3+((16540*dth2**2+(33080*dth1+33080*dth0)*dth2+16540*dth1**2+33080*dth0*dth1+16540*dth0**2)*cos(th0)*sin(th0)**2-72000*tau2*sin(th0)+(16540*dth2**2+(33080*dth1+33080*dth0)*dth2+16540*dth1**2+33080*dth0*dth1+16540*dth0**2)*cos(th0)**3+((-21640*dth2**2)+((-43280*dth1)-43280*dth0)*dth2-21640*dth1**2-43280*dth0*dth1-21640*dth0**2)*cos(th0))*cos(th1))*cos(th2)+((((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)*sin(2*th0)+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*cos(2*th0)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)*sin(th0)**2+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)**3)*sin(th1)+((12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*cos(th0)*sin(2*th0)+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)*cos(2*th0))*cos(th1)+20475*dth0**2*cos(th0)*sin(2*th0)+(229320-20475*dth0**2*sin(th0))*cos(2*th0)-401310*cos(th0)**2-39000*tau1*cos(th0))*sin(2*th1)+((((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*sin(2*th0)+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)*cos(2*th0)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*sin(th0)**3+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+(((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)*sin(2*th0)+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*cos(2*th0))*cos(th1)+(229320-20475*dth0**2*sin(th0))*sin(2*th0)-20475*dth0**2*cos(th0)*cos(2*th0)+((-401310*cos(th0))-39000*tau1)*sin(th0))*cos(2*th1)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*sin(th0)*sin(th1)**3+(((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*cos(th0)*cos(th1)+42900*dth0**2*cos(th0)*sin(th0)**2-420420*cos(th0)*sin(th0)+42900*dth0**2*cos(th0)**3-40950*dth0**2*cos(th0))*sin(th1)**2+(((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*sin(th0)*cos(th1)**2+((-63960*dth0**2*sin(th0)**3)+626808*sin(th0)**2-63960*dth0**2*cos(th0)**2*sin(th0)+420420*cos(th0)**2)*cos(th1)+((-102115*dth1**2)-204230*dth0*dth1-102115*dth0**2)*sin(th0)**3+(((-102115*dth1**2)-204230*dth0*dth1-102115*dth0**2)*cos(th0)**2+70330*dth1**2+140660*dth0*dth1+70330*dth0**2)*sin(th0)+(66000*tau2-66000*tau1)*cos(th0))*sin(th1)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)*cos(th1)**3+(40950*dth0**2*cos(th0)-626808*cos(th0)*sin(th0))*cos(th1)**2+((53755*dth1**2+107510*dth0*dth1+53755*dth0**2)*cos(th0)*sin(th0)**2+(98400*tau1-98400*tau2)*sin(th0)+(53755*dth1**2+107510*dth0*dth1+53755*dth0**2)*cos(th0)**3+((-70330*dth1**2)-140660*dth0*dth1-70330*dth0**2)*cos(th0))*cos(th1)+86835*dth0**2*cos(th0)*sin(th0)**2+(522438*cos(th0)+239800*tau1)*sin(th0)+86835*dth0**2*cos(th0)**3-113610*dth0**2*cos(th0))/3.2E+7)
    dd1 = rdetA * (-((((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0))*cos(th1))*sin(2*th1)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1))*cos(2*th1)+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**3)*sin(th1)**3+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)*sin(th1)**2+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**3)*cos(th1)**2*sin(th1)+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**3)*sin(th2)+((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)*sin(th0)**2+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0))*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0))*cos(th1))*sin(2*th1)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0))*cos(th1))*cos(2*th1))*cos(th2)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th0)**2+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**3+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0))*sin(th1)+(((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0))*cos(th1)-6300*dth0**2*cos(th0)*sin(2*th0)+(6300*dth0**2*sin(th0)-70560)*cos(2*th0)+12600*dth0**2*sin(th0)+123480*cos(th0)**2+12000*tau1*cos(th0)-141120)*sin(2*th1)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*sin(th0)**3+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0))*cos(th1)+(6300*dth0**2*sin(th0)-70560)*sin(2*th0)+6300*dth0**2*cos(th0)*cos(2*th0)+(123480*cos(th0)+12000*tau1)*sin(th0))*cos(2*th1)+(17160*dth0**2*cos(th0)*sin(th0)**2-168168*cos(th0)*sin(th0)+17160*dth0**2*cos(th0)**3)*sin(th1)**2+(((-7800*dth0**2*sin(th0)**3)+76440*sin(th0)**2-7800*dth0**2*cos(th0)**2*sin(th0)+168168*cos(th0)**2)*cos(th1)+(26400*tau2-26400*tau1)*cos(th0))*sin(th1)-76440*cos(th0)*sin(th0)*cos(th1)**2+(12000*tau1-12000*tau2)*sin(th0)*cos(th1))*sin(2*th2)+((((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1))*sin(2*th1)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0))*sin(th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0))*cos(th1))*cos(2*th1)+((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)**3+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**3)*cos(th1)*sin(th1)**2+(((2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*sin(th0)**3+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**2+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*cos(th0)*sin(2*th0)+((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*sin(th0)*cos(2*th0))*sin(th1)+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**3)*cos(th1)**3+((10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*cos(th0)*cos(2*th0)+((-28160*dth2**2)+((-56320*dth1)-56320*dth0)*dth2-28160*dth1**2-56320*dth0*dth1-28160*dth0**2)*cos(th0)*sin(th0)**2+((-28160*dth2**2)+((-56320*dth1)-56320*dth0)*dth2-28160*dth1**2-56320*dth0*dth1-28160*dth0**2)*cos(th0)**3)*cos(th1))*sin(th2)+((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)*sin(2*th0)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*cos(2*th0))*cos(th1))*sin(2*th1)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)*cos(2*th0)+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)*sin(th0)**2+(2400*dth2**2+(4800*dth1+4800*dth0)*dth2+2400*dth1**2+4800*dth0*dth1+2400*dth0**2)*cos(th0)**3+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*cos(th0))*sin(th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)*sin(2*th0)+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)*cos(2*th0)+((-2400*dth2**2)+((-4800*dth1)-4800*dth0)*dth2-2400*dth1**2-4800*dth0*dth1-2400*dth0**2)*sin(th0))*cos(th1))*cos(2*th1)+((10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*cos(th0)*cos(2*th0)+((-28160*dth2**2)+((-56320*dth1)-56320*dth0)*dth2-28160*dth1**2-56320*dth0*dth1-28160*dth0**2)*cos(th0)*sin(th0)**2+((-28160*dth2**2)+((-56320*dth1)-56320*dth0)*dth2-28160*dth1**2-56320*dth0*dth1-28160*dth0**2)*cos(th0)**3)*sin(th1)+(((-10240*dth2**2)+((-20480*dth1)-20480*dth0)*dth2-10240*dth1**2-20480*dth0*dth1-10240*dth0**2)*cos(th0)*sin(2*th0)+(10240*dth2**2+(20480*dth1+20480*dth0)*dth2+10240*dth1**2+20480*dth0*dth1+10240*dth0**2)*sin(th0)*cos(2*th0))*cos(th1))*cos(th2)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*sin(th0)**3+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0))*cos(th1)+(6300*dth0**2*sin(th0)-70560)*sin(2*th0)+6300*dth0**2*cos(th0)*cos(2*th0)+(123480*cos(th0)+12000*tau1)*sin(th0))*sin(2*th1)+((((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0)+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)*sin(th0)**2+(7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**3+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*cos(th0))*sin(th1)+((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0)+((-7800*dth1**2)-15600*dth0*dth1-7800*dth0**2)*sin(th0))*cos(th1)+6300*dth0**2*cos(th0)*sin(2*th0)+(70560-6300*dth0**2*sin(th0))*cos(2*th0)-12600*dth0**2*sin(th0)-123480*cos(th0)**2-12000*tau1*cos(th0)+141120)*cos(2*th1)+((-7800*dth0**2*sin(th0)**3)+76440*sin(th0)**2-7800*dth0**2*cos(th0)**2*sin(th0))*sin(th1)**2+(((-17160*dth0**2*cos(th0)*sin(th0)**2)+91728*cos(th0)*sin(th0)-17160*dth0**2*cos(th0)**3)*cos(th1)+(33280*dth1**2+66560*dth0*dth1+33280*dth0**2)*sin(th0)*sin(2*th0)+(33280*dth1**2+66560*dth0*dth1+33280*dth0**2)*cos(th0)*cos(2*th0)+((-91520*dth1**2)-183040*dth0*dth1-91520*dth0**2)*cos(th0)*sin(th0)**2+(12000*tau1-12000*tau2)*sin(th0)+((-91520*dth1**2)-183040*dth0*dth1-91520*dth0**2)*cos(th0)**3)*sin(th1)-168168*cos(th0)**2*cos(th1)**2+(((-33280*dth1**2)-66560*dth0*dth1-33280*dth0**2)*cos(th0)*sin(2*th0)+(33280*dth1**2+66560*dth0*dth1+33280*dth0**2)*sin(th0)*cos(2*th0)+(26400*tau1-26400*tau2)*cos(th0))*cos(th1)-53760*dth0**2*cos(th0)*sin(2*th0)+(53760*dth0**2*sin(th0)-602112)*cos(2*th0)+1448832*cos(th0)**2+140800*tau1*cos(th0))*cos(2*th2)+((12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*sin(th0)*sin(th1)+((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*cos(th0)*cos(th1))*sin(th2)**3+((((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*cos(th0)*sin(th1)+((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*sin(th0)*cos(th1))*cos(th2)+(((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)*sin(th0)**2+((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)**3)*sin(th1)**3+(((4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*sin(th0)**3+(4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)+195216*cos(th0)**2)*sin(th1)**2+((((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)*sin(th0)**2+((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)**3)*cos(th1)**2+((-19920*dth0**2*cos(th0)*sin(th0)**2)+148176*cos(th0)*sin(th0)-19920*dth0**2*cos(th0)**3)*cos(th1)+((-41080*dth1**2)-82160*dth0*dth1-41080*dth0**2)*cos(th0))*sin(th1)+((4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*sin(th0)**3+(4800*dth1**2+9600*dth0*dth1+4800*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**3+(4800*dth0**2*sin(th0)**3-47040*sin(th0)**2+4800*dth0**2*cos(th0)**2*sin(th0))*cos(th1)**2+((-41080*dth1**2)-82160*dth0*dth1-41080*dth0**2)*sin(th0)*cos(th1)-66360*dth0**2*sin(th0)+743232)*sin(th2)**2+((((-12640*dth2**2)+((-25280*dth1)-25280*dth0)*dth2-12640*dth1**2-25280*dth0*dth1-12640*dth0**2)*sin(th0)*sin(th1)+(12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*cos(th0)*cos(th1))*cos(th2)**2+((((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*sin(th0)**3+((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)**3+((((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)*sin(th0)**2+((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)**3)*cos(th1)-19920*dth0**2*cos(th0)*sin(th0)**2+301056*cos(th0)*sin(th0)-19920*dth0**2*cos(th0)**3)*sin(th1)**2+((((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*sin(th0)**3+((-10800*dth1**2)-21600*dth0*dth1-10800*dth0**2)*cos(th0)**2*sin(th0))*cos(th1)**2+((-6000*dth0**2*sin(th0)**3)+58800*sin(th0)**2-6000*dth0**2*cos(th0)**2*sin(th0)-54096*cos(th0)**2)*cos(th1))*sin(th1)+(((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)*sin(th0)**2+((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)**3)*cos(th1)**3+((-14400*dth0**2*cos(th0)*sin(th0)**2)+188160*cos(th0)*sin(th0)-14400*dth0**2*cos(th0)**3)*cos(th1)**2)*cos(th2)+(((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0))*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**2*sin(th0))*cos(th1))*sin(2*th1)+(((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*cos(2*th0))*sin(th1)+((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th0)**2+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)**3)*cos(th1))*cos(2*th1)+(((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*sin(th0)**3+(((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)**2+7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0))*sin(th1)**3+(((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)*sin(th0)**2+((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)**3+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0))*cos(th1)*sin(th1)**2+((((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*sin(th0)**3+(((-13200*dth2**2)+((-26400*dth1)-26400*dth0)*dth2-13200*dth1**2-26400*dth0*dth1-13200*dth0**2)*cos(th0)**2-7800*dth2**2+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*sin(th0))*cos(th1)**2+((-16540*dth2**2)+((-33080*dth1)-33080*dth0)*dth2-16540*dth1**2-33080*dth0*dth1-16540*dth0**2)*sin(th0)**3+(((-16540*dth2**2)+((-33080*dth1)-33080*dth0)*dth2-16540*dth1**2-33080*dth0*dth1-16540*dth0**2)*cos(th0)**2+21640*dth2**2+(43280*dth1+43280*dth0)*dth2+21640*dth1**2+43280*dth0*dth1+21640*dth0**2)*sin(th0)+99600*tau2*cos(th0))*sin(th1)+(((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)*sin(th0)**2+((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0))*cos(th1)**3+((31420*dth2**2+(62840*dth1+62840*dth0)*dth2+31420*dth1**2+62840*dth0*dth1+31420*dth0**2)*cos(th0)*sin(th0)**2-24000*tau2*sin(th0)+(31420*dth2**2+(62840*dth1+62840*dth0)*dth2+31420*dth1**2+62840*dth0*dth1+31420*dth0**2)*cos(th0)**3+((-21640*dth2**2)+((-43280*dth1)-43280*dth0)*dth2-21640*dth1**2-43280*dth0*dth1-21640*dth0**2)*cos(th0))*cos(th1))*sin(th2)+((12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*cos(th0)*sin(th1)+(12640*dth2**2+(25280*dth1+25280*dth0)*dth2+12640*dth1**2+25280*dth0*dth1+12640*dth0**2)*sin(th0)*cos(th1))*cos(th2)**3+(((-10800*dth0**2*sin(th0)**3)+105840*sin(th0)**2-10800*dth0**2*cos(th0)**2*sin(th0))*sin(th1)**2+(((-14400*dth0**2*cos(th0)*sin(th0)**2)+35280*cos(th0)*sin(th0)-14400*dth0**2*cos(th0)**3)*cos(th1)+(41080*dth1**2+82160*dth0*dth1+41080*dth0**2)*cos(th0))*sin(th1)-141120*cos(th0)**2*cos(th1)**2+(41080*dth1**2+82160*dth0*dth1+41080*dth0**2)*sin(th0)*cos(th1)+66360*dth0**2*sin(th0)-743232)*cos(th2)**2+(((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)**3+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)*sin(2*th0)+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*cos(2*th0))*cos(th1))*sin(2*th1)+(((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)*cos(2*th0)+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th0)**2+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)**3)*sin(th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)*sin(2*th0)+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)*cos(2*th0))*cos(th1))*cos(2*th1)+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*cos(th0)*sin(th1)**3+((-7800*dth2**2)+((-15600*dth1)-15600*dth0)*dth2-7800*dth1**2-15600*dth0*dth1-7800*dth0**2)*sin(th0)*cos(th1)*sin(th1)**2+((7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*cos(th0)*cos(th1)**2+(31420*dth2**2+(62840*dth1+62840*dth0)*dth2+31420*dth1**2+62840*dth0*dth1+31420*dth0**2)*cos(th0)*sin(th0)**2+54000*tau2*sin(th0)+(31420*dth2**2+(62840*dth1+62840*dth0)*dth2+31420*dth1**2+62840*dth0*dth1+31420*dth0**2)*cos(th0)**3+((-21640*dth2**2)+((-43280*dth1)-43280*dth0)*dth2-21640*dth1**2-43280*dth0*dth1-21640*dth0**2)*cos(th0))*sin(th1)+(7800*dth2**2+(15600*dth1+15600*dth0)*dth2+7800*dth1**2+15600*dth0*dth1+7800*dth0**2)*sin(th0)*cos(th1)**3+((16540*dth2**2+(33080*dth1+33080*dth0)*dth2+16540*dth1**2+33080*dth0*dth1+16540*dth0**2)*sin(th0)**3+((16540*dth2**2+(33080*dth1+33080*dth0)*dth2+16540*dth1**2+33080*dth0*dth1+16540*dth0**2)*cos(th0)**2-21640*dth2**2+((-43280*dth1)-43280*dth0)*dth2-21640*dth1**2-43280*dth0*dth1-21640*dth0**2)*sin(th0)+72000*tau2*cos(th0))*cos(th1))*cos(th2)+((((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*sin(2*th0)+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)*cos(2*th0)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*sin(th0)**3+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)**2*sin(th0))*sin(th1)+(((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)*sin(2*th0)+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*cos(2*th0))*cos(th1)+(229320-20475*dth0**2*sin(th0))*sin(2*th0)-20475*dth0**2*cos(th0)*cos(2*th0)+((-401310*cos(th0))-39000*tau1)*sin(th0))*sin(2*th1)+(((12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)*sin(2*th0)+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*cos(th0)*cos(2*th0)+((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*cos(th0)*sin(th0)**2+((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*cos(th0)**3)*sin(th1)+(((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)*sin(2*th0)+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)*cos(2*th0))*cos(th1)-20475*dth0**2*cos(th0)*sin(2*th0)+(20475*dth0**2*sin(th0)-229320)*cos(2*th0)+401310*cos(th0)**2+39000*tau1*cos(th0))*cos(2*th1)+((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*cos(th0)*sin(th1)**3+(((-25350*dth1**2)-50700*dth0*dth1-25350*dth0**2)*sin(th0)*cos(th1)+42900*dth0**2*sin(th0)**3-420420*sin(th0)**2+(42900*dth0**2*cos(th0)**2-40950*dth0**2)*sin(th0)+458640)*sin(th1)**2+((25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*cos(th0)*cos(th1)**2+(63960*dth0**2*cos(th0)*sin(th0)**2-206388*cos(th0)*sin(th0)+63960*dth0**2*cos(th0)**3)*cos(th1)+(102115*dth1**2+204230*dth0*dth1+102115*dth0**2)*cos(th0)*sin(th0)**2+(66000*tau2-66000*tau1)*sin(th0)+(102115*dth1**2+204230*dth0*dth1+102115*dth0**2)*cos(th0)**3+((-70330*dth1**2)-140660*dth0*dth1-70330*dth0**2)*cos(th0))*sin(th1)+(25350*dth1**2+50700*dth0*dth1+25350*dth0**2)*sin(th0)*cos(th1)**3+(40950*dth0**2*sin(th0)+626808*cos(th0)**2-458640)*cos(th1)**2+((53755*dth1**2+107510*dth0*dth1+53755*dth0**2)*sin(th0)**3+((53755*dth1**2+107510*dth0*dth1+53755*dth0**2)*cos(th0)**2-70330*dth1**2-140660*dth0*dth1-70330*dth0**2)*sin(th0)+(98400*tau2-98400*tau1)*cos(th0))*cos(th1)+86835*dth0**2*sin(th0)**3-972552*sin(th0)**2+(86835*dth0**2*cos(th0)**2-113610*dth0**2)*sin(th0)-1494990*cos(th0)**2-239800*tau1*cos(th0)+1272432)/3.2E+7)
    dd2 = rdetA * ((((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*cos(th1)*sin(2*th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*sin(th1)*cos(2*th1)+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2)*sin(th1)**3+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2)*cos(th1)**2*sin(th1))*sin(th2)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*sin(th1)*sin(2*th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*cos(th1)*cos(2*th1))*cos(th2)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*sin(th1)-70560*cos(th0))*sin(2*th1)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*cos(th1)+6300*dth0**2*sin(th0)**2-70560*sin(th0)+6300*dth0**2*cos(th0)**2)*cos(2*th1)+(17160*dth0**2*sin(th0)**2-168168*sin(th0)+17160*dth0**2*cos(th0)**2)*sin(th1)**2+(168168*cos(th0)*cos(th1)+26400*tau2-26400*tau1)*sin(th1))*sin(2*th2)+(((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*sin(th1)*sin(2*th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*cos(th1)*cos(2*th1)+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2)*cos(th1)*sin(th1)**2+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2)*cos(th1)**3+((14080*dth2**2+(28160*dth1+28160*dth0)*dth2+14080*dth1**2+28160*dth0*dth1+14080*dth0**2)*sin(th0)**2+(14080*dth2**2+(28160*dth1+28160*dth0)*dth2+14080*dth1**2+28160*dth0*dth1+14080*dth0**2)*cos(th0)**2)*cos(th1))*sin(th2)+(((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*cos(th1)*sin(2*th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*sin(th1)*cos(2*th1)+((14080*dth2**2+(28160*dth1+28160*dth0)*dth2+14080*dth1**2+28160*dth0*dth1+14080*dth0**2)*sin(th0)**2+(14080*dth2**2+(28160*dth1+28160*dth0)*dth2+14080*dth1**2+28160*dth0*dth1+14080*dth0**2)*cos(th0)**2)*sin(th1))*cos(th2)+(((3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*cos(th1)+6300*dth0**2*sin(th0)**2-70560*sin(th0)+6300*dth0**2*cos(th0)**2)*sin(2*th1)+((((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*sin(th1)+70560*cos(th0))*cos(2*th1)+(((-17160*dth0**2*sin(th0)**2)+168168*sin(th0)-17160*dth0**2*cos(th0)**2)*cos(th1)+(45760*dth1**2+91520*dth0*dth1+45760*dth0**2)*sin(th0)**2+(45760*dth1**2+91520*dth0*dth1+45760*dth0**2)*cos(th0)**2)*sin(th1)-168168*cos(th0)*cos(th1)**2+(26400*tau1-26400*tau2)*cos(th1)-827904*cos(th0))*cos(2*th2)+((19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*sin(th0)**2+(19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*cos(th0)**2)*cos(th1)*sin(th2)**3+(((19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*sin(th0)**2+(19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*cos(th0)**2)*sin(th1)*cos(th2)+(((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*sin(th0)**2+((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)**2)*sin(th1)**3+195216*cos(th0)*sin(th1)**2+((((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*sin(th0)**2+((-19920*dth1**2)-39840*dth0*dth1-19920*dth0**2)*cos(th0)**2)*cos(th1)**2+((-19920*dth0**2*sin(th0)**2)+195216*sin(th0)-19920*dth0**2*cos(th0)**2)*cos(th1)+(62920*dth1**2+125840*dth0*dth1+62920*dth0**2)*sin(th0)**2+(62920*dth1**2+125840*dth0*dth1+62920*dth0**2)*cos(th0)**2)*sin(th1)-996072*cos(th0)-96800*tau1)*sin(th2)**2+((((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*sin(th0)**2+((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*cos(th0)**2)*cos(th1)*cos(th2)**2+(((((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*sin(th0)**2+((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)**2)*cos(th1)-19920*dth0**2*sin(th0)**2+195216*sin(th0)-19920*dth0**2*cos(th0)**2)*sin(th1)**2-54096*cos(th0)*cos(th1)*sin(th1)+(((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*sin(th0)**2+((-14400*dth1**2)-28800*dth0*dth1-14400*dth0**2)*cos(th0)**2)*cos(th1)**3+((-14400*dth0**2*sin(th0)**2)+141120*sin(th0)-14400*dth0**2*cos(th0)**2)*cos(th1)**2)*cos(th2)+((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*sin(th1)*sin(2*th1)+((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*cos(th1)*cos(2*th1)+(((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*sin(th0)**2+((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)**2)*cos(th1)*sin(th1)**2+99600*tau2*sin(th1)+(((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*sin(th0)**2+((-19680*dth2**2)+((-39360*dth1)-39360*dth0)*dth2-19680*dth1**2-39360*dth0*dth1-19680*dth0**2)*cos(th0)**2)*cos(th1)**3+((9780*dth2**2+(19560*dth1+19560*dth0)*dth2+9780*dth1**2+19560*dth0*dth1+9780*dth0**2)*sin(th0)**2+(9780*dth2**2+(19560*dth1+19560*dth0)*dth2+9780*dth1**2+19560*dth0*dth1+9780*dth0**2)*cos(th0)**2)*cos(th1))*sin(th2)+(((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*sin(th0)**2+((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*cos(th0)**2)*sin(th1)*cos(th2)**3+((((-14400*dth0**2*sin(th0)**2)+141120*sin(th0)-14400*dth0**2*cos(th0)**2)*cos(th1)+((-62920*dth1**2)-125840*dth0*dth1-62920*dth0**2)*sin(th0)**2+((-62920*dth1**2)-125840*dth0*dth1-62920*dth0**2)*cos(th0)**2)*sin(th1)-141120*cos(th0)*cos(th1)**2+996072*cos(th0)+96800*tau1)*cos(th2)**2+((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*cos(th1)*sin(2*th1)+((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*sin(th1)*cos(2*th1)+((9780*dth2**2+(19560*dth1+19560*dth0)*dth2+9780*dth1**2+19560*dth0*dth1+9780*dth0**2)*sin(th0)**2+(9780*dth2**2+(19560*dth1+19560*dth0)*dth2+9780*dth1**2+19560*dth0*dth1+9780*dth0**2)*cos(th0)**2)*sin(th1)+72000*tau2*cos(th1))*cos(th2)+((((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)**2+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)**2)*cos(th1)-20475*dth0**2*sin(th0)**2+229320*sin(th0)-20475*dth0**2*cos(th0)**2)*sin(2*th1)+(((12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)**2+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*cos(th0)**2)*sin(th1)-229320*cos(th0))*cos(2*th1)+((63960*dth0**2*sin(th0)**2-626808*sin(th0)+63960*dth0**2*cos(th0)**2)*cos(th1)+(31785*dth1**2+63570*dth0*dth1+31785*dth0**2)*sin(th0)**2+(31785*dth1**2+63570*dth0*dth1+31785*dth0**2)*cos(th0)**2)*sin(th1)+626808*cos(th0)*cos(th1)**2+(98400*tau2-98400*tau1)*cos(th1)-326928*cos(th0)-168800*tau1)/1.6E+7)
    dd3 = rdetA * (((((((1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*sin(th0)**2+(1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*cos(th0)**2)*sin(th1)**2+((1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*sin(th0)**2+(1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*cos(th0)**2)*cos(th1)**2+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*cos(th1))*sin(2*th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*sin(th1)*cos(2*th1)+((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2)*sin(th1)**3+(((5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*sin(th0)**2+(5280*dth2**2+(10560*dth1+10560*dth0)*dth2+5280*dth1**2+10560*dth0*dth1+5280*dth0**2)*cos(th0)**2)*cos(th1)**2+(((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*sin(th0)**2+((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*cos(th0)**2)*cos(th1))*sin(th1))*sin(th2)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*sin(th1)*sin(2*th1)+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*cos(th1)*cos(2*th1)+(((-2640*dth2**2)+((-5280*dth1)-5280*dth0)*dth2-2640*dth1**2-5280*dth0*dth1-2640*dth0**2)*sin(th0)**2+((-2640*dth2**2)+((-5280*dth1)-5280*dth0)*dth2-2640*dth1**2-5280*dth0*dth1-2640*dth0**2)*cos(th0)**2)*sin(th1)**2+(((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*cos(th1)**2)*cos(th2)+((((-3900*dth1**2)-7800*dth0*dth1-8580*dth0**2)*sin(th0)**2+45864*sin(th0)+((-3900*dth1**2)-7800*dth0*dth1-8580*dth0**2)*cos(th0)**2)*sin(th1)-45864*cos(th0)*cos(th1)+70560*cos(th0)-7200*tau2+7200*tau1)*sin(2*th1)+((((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*cos(th1)-6300*dth0**2*sin(th0)**2+70560*sin(th0)-6300*dth0**2*cos(th0)**2)*cos(2*th1)+(((-8580*dth1**2)-17160*dth0*dth1-25740*dth0**2)*sin(th0)**2+168168*sin(th0)+((-8580*dth1**2)-17160*dth0*dth1-25740*dth0**2)*cos(th0)**2)*sin(th1)**2+((-168168*cos(th0)*cos(th1))+116424*cos(th0)-26400*tau2+52800*tau1)*sin(th1)+(((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*cos(th1)**2+((-6300*dth0**2*sin(th0)**2)+70560*sin(th0)-6300*dth0**2*cos(th0)**2)*cos(th1))*sin(2*th2)+((((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*sin(th1)*sin(2*th1)+((((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*sin(th0)**2+((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*cos(th0)**2)*sin(th1)**2+(((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*sin(th0)**2+((-1440*dth2**2)+((-2880*dth1)-2880*dth0)*dth2-1440*dth1**2-2880*dth0*dth1-1440*dth0**2)*cos(th0)**2)*cos(th1)**2+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*cos(th1))*cos(2*th1)+((((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2)*cos(th1)+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*sin(th1)**2+(((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*sin(th0)**2+((-5280*dth2**2)+((-10560*dth1)-10560*dth0)*dth2-5280*dth1**2-10560*dth0*dth1-5280*dth0**2)*cos(th0)**2)*cos(th1)**3+((2640*dth2**2+(5280*dth1+5280*dth0)*dth2+2640*dth1**2+5280*dth0*dth1+2640*dth0**2)*sin(th0)**2+(2640*dth2**2+(5280*dth1+5280*dth0)*dth2+2640*dth1**2+5280*dth0*dth1+2640*dth0**2)*cos(th0)**2)*cos(th1)**2+(((-14080*dth2**2)+((-28160*dth1)-28160*dth0)*dth2-14080*dth1**2-28160*dth0*dth1-14080*dth0**2)*sin(th0)**2+((-14080*dth2**2)+((-28160*dth1)-28160*dth0)*dth2-14080*dth1**2-28160*dth0*dth1-14080*dth0**2)*cos(th0)**2)*cos(th1))*sin(th2)+((((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*sin(th0)**2+((-1200*dth2**2)+((-2400*dth1)-2400*dth0)*dth2-1200*dth1**2-2400*dth0*dth1-1200*dth0**2)*cos(th0)**2)*cos(th1)*sin(2*th1)+((1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*sin(th0)**2+(1200*dth2**2+(2400*dth1+2400*dth0)*dth2+1200*dth1**2+2400*dth0*dth1+1200*dth0**2)*cos(th0)**2)*sin(th1)*cos(2*th1)+(((1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*sin(th0)**2+(1440*dth2**2+(2880*dth1+2880*dth0)*dth2+1440*dth1**2+2880*dth0*dth1+1440*dth0**2)*cos(th0)**2)*cos(th1)+((-14080*dth2**2)+((-28160*dth1)-28160*dth0)*dth2-14080*dth1**2-28160*dth0*dth1-14080*dth0**2)*sin(th0)**2+((-14080*dth2**2)+((-28160*dth1)-28160*dth0)*dth2-14080*dth1**2-28160*dth0*dth1-14080*dth0**2)*cos(th0)**2)*sin(th1))*cos(th2)+((((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth1**2)-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*cos(th1)-6300*dth0**2*sin(th0)**2+70560*sin(th0)-6300*dth0**2*cos(th0)**2)*sin(2*th1)+(((3900*dth1**2+7800*dth0*dth1+8580*dth0**2)*sin(th0)**2-45864*sin(th0)+(3900*dth1**2+7800*dth0*dth1+8580*dth0**2)*cos(th0)**2)*sin(th1)+45864*cos(th0)*cos(th1)-70560*cos(th0)+7200*tau2-7200*tau1)*cos(2*th1)+(((4680*dth1**2+9360*dth0*dth1+21840*dth0**2)*sin(th0)**2-168168*sin(th0)+(4680*dth1**2+9360*dth0*dth1+21840*dth0**2)*cos(th0)**2)*cos(th1)+((-45760*dth1**2)-91520*dth0*dth1-52060*dth0**2)*sin(th0)**2+70560*sin(th0)+((-45760*dth1**2)-91520*dth0*dth1-52060*dth0**2)*cos(th0)**2)*sin(th1)+168168*cos(th0)*cos(th1)**2+((-116424*cos(th0))+26400*tau2-52800*tau1)*cos(th1)+827904*cos(th0))*cos(2*th2)+(((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*sin(th0)**2+((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*cos(th0)**2)*cos(th1)*sin(th2)**3+((((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*sin(th0)**2+((-19360*dth2**2)+((-38720*dth1)-38720*dth0)*dth2-19360*dth1**2-38720*dth0*dth1-19360*dth0**2)*cos(th0)**2)*sin(th1)*cos(th2)+(((4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*sin(th0)**2+(4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*cos(th0)**2)*sin(th1)**2-45864*cos(th0)*sin(th1)+((4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*sin(th0)**2+(4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*cos(th0)**2)*cos(th1)**2+(4680*dth0**2*sin(th0)**2-45864*sin(th0)+4680*dth0**2*cos(th0)**2)*cos(th1))*sin(2*th1)+((19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*sin(th0)**2+(19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*cos(th0)**2)*sin(th1)**3-195216*cos(th0)*sin(th1)**2+(((19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*sin(th0)**2+(19920*dth1**2+39840*dth0*dth1+19920*dth0**2)*cos(th0)**2)*cos(th1)**2+(19920*dth0**2*sin(th0)**2-195216*sin(th0)+19920*dth0**2*cos(th0)**2)*cos(th1)+((-62920*dth1**2)-125840*dth0*dth1-62920*dth0**2)*sin(th0)**2+((-62920*dth1**2)-125840*dth0*dth1-62920*dth0**2)*cos(th0)**2)*sin(th1)+996072*cos(th0)+96800*tau1)*sin(th2)**2+(((19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*sin(th0)**2+(19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*cos(th0)**2)*cos(th1)*cos(th2)**2+(((4680*dth0**2*sin(th0)**2-45864*sin(th0)+4680*dth0**2*cos(th0)**2)*sin(th1)+45864*cos(th0)*cos(th1))*sin(2*th1)+((((-4680*dth1**2)-9360*dth0*dth1-4680*dth0**2)*sin(th0)**2+((-4680*dth1**2)-9360*dth0*dth1-4680*dth0**2)*cos(th0)**2)*sin(th1)**2+45864*cos(th0)*sin(th1)+(((-4680*dth1**2)-9360*dth0*dth1-4680*dth0**2)*sin(th0)**2+((-4680*dth1**2)-9360*dth0*dth1-4680*dth0**2)*cos(th0)**2)*cos(th1)**2+((-4680*dth0**2*sin(th0)**2)+45864*sin(th0)-4680*dth0**2*cos(th0)**2)*cos(th1))*cos(2*th1)+(((14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*sin(th0)**2+(14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*cos(th0)**2)*cos(th1)+(19080*dth1**2+38160*dth0*dth1+39000*dth0**2)*sin(th0)**2-195216*sin(th0)+(19080*dth1**2+38160*dth0*dth1+39000*dth0**2)*cos(th0)**2)*sin(th1)**2+(54096*cos(th0)*cos(th1)-186984*cos(th0))*sin(th1)+((14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*sin(th0)**2+(14400*dth1**2+28800*dth0*dth1+14400*dth0**2)*cos(th0)**2)*cos(th1)**3+((19080*dth1**2+38160*dth0*dth1+33480*dth0**2)*sin(th0)**2-141120*sin(th0)+(19080*dth1**2+38160*dth0*dth1+33480*dth0**2)*cos(th0)**2)*cos(th1)**2+(19080*dth0**2*sin(th0)**2-186984*sin(th0)+19080*dth0**2*cos(th0)**2)*cos(th1))*cos(th2)+((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*sin(th1)-23400*tau2)*sin(2*th1)+(((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*cos(th1)*cos(2*th1)+(((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*sin(th0)**2+(19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*cos(th0)**2)*cos(th1)+(9240*dth2**2+(18480*dth1+18480*dth0)*dth2+9240*dth1**2+18480*dth0*dth1+9240*dth0**2)*sin(th0)**2+(9240*dth2**2+(18480*dth1+18480*dth0)*dth2+9240*dth1**2+18480*dth0*dth1+9240*dth0**2)*cos(th0)**2)*sin(th1)**2-99600*tau2*sin(th1)+((19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*sin(th0)**2+(19680*dth2**2+(39360*dth1+39360*dth0)*dth2+19680*dth1**2+39360*dth0*dth1+19680*dth0**2)*cos(th0)**2)*cos(th1)**3+((6000*dth2**2+(12000*dth1+12000*dth0)*dth2+6000*dth1**2+12000*dth0*dth1+6000*dth0**2)*sin(th0)**2+(6000*dth2**2+(12000*dth1+12000*dth0)*dth2+6000*dth1**2+12000*dth0*dth1+6000*dth0**2)*cos(th0)**2)*cos(th1)**2+(((-9780*dth2**2)+((-19560*dth1)-19560*dth0)*dth2-9780*dth1**2-19560*dth0*dth1-9780*dth0**2)*sin(th0)**2+((-9780*dth2**2)+((-19560*dth1)-19560*dth0)*dth2-9780*dth1**2-19560*dth0*dth1-9780*dth0**2)*cos(th0)**2)*cos(th1))*sin(th2)+((19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*sin(th0)**2+(19360*dth2**2+(38720*dth1+38720*dth0)*dth2+19360*dth1**2+38720*dth0*dth1+19360*dth0**2)*cos(th0)**2)*sin(th1)*cos(th2)**3+((((-4680*dth0**2*sin(th0)**2)+45864*sin(th0)-4680*dth0**2*cos(th0)**2)*sin(th1)-45864*cos(th0)*cos(th1))*cos(2*th1)+((14400*dth0**2*sin(th0)**2-141120*sin(th0)+14400*dth0**2*cos(th0)**2)*cos(th1)+(62920*dth1**2+125840*dth0*dth1+82000*dth0**2)*sin(th0)**2-186984*sin(th0)+(62920*dth1**2+125840*dth0*dth1+82000*dth0**2)*cos(th0)**2)*sin(th1)+141120*cos(th0)*cos(th1)**2+186984*cos(th0)*cos(th1)-996072*cos(th0)-96800*tau1)*cos(th2)**2+(((3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*sin(th0)**2+(3900*dth2**2+(7800*dth1+7800*dth0)*dth2+3900*dth1**2+7800*dth0*dth1+3900*dth0**2)*cos(th0)**2)*cos(th1)*sin(2*th1)+((((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*sin(th0)**2+((-3900*dth2**2)+((-7800*dth1)-7800*dth0)*dth2-3900*dth1**2-7800*dth0*dth1-3900*dth0**2)*cos(th0)**2)*sin(th1)+23400*tau2)*cos(2*th1)+((((-3240*dth2**2)+((-6480*dth1)-6480*dth0)*dth2-3240*dth1**2-6480*dth0*dth1-3240*dth0**2)*sin(th0)**2+((-3240*dth2**2)+((-6480*dth1)-6480*dth0)*dth2-3240*dth1**2-6480*dth0*dth1-3240*dth0**2)*cos(th0)**2)*cos(th1)+((-9780*dth2**2)+((-19560*dth1)-19560*dth0)*dth2-9780*dth1**2-19560*dth0*dth1-9780*dth0**2)*sin(th0)**2+((-9780*dth2**2)+((-19560*dth1)-19560*dth0)*dth2-9780*dth1**2-19560*dth0*dth1-9780*dth0**2)*cos(th0)**2)*sin(th1)-72000*tau2*cos(th1)-95400*tau2)*cos(th2)+(((12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*sin(th0)**2+(12675*dth1**2+25350*dth0*dth1+12675*dth0**2)*cos(th0)**2)*cos(th1)+20475*dth0**2*sin(th0)**2-229320*sin(th0)+20475*dth0**2*cos(th0)**2)*sin(2*th1)+((((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*sin(th0)**2+((-12675*dth1**2)-25350*dth0*dth1-12675*dth0**2)*cos(th0)**2)*sin(th1)+229320*cos(th0))*cos(2*th1)+((((-10530*dth1**2)-21060*dth0*dth1-74490*dth0**2)*sin(th0)**2+626808*sin(th0)+((-10530*dth1**2)-21060*dth0*dth1-74490*dth0**2)*cos(th0)**2)*cos(th1)+((-31785*dth1**2)-63570*dth0*dth1-48615*dth0**2)*sin(th0)**2+116424*sin(th0)+((-31785*dth1**2)-63570*dth0*dth1-48615*dth0**2)*cos(th0)**2)*sin(th1)-626808*cos(th0)*cos(th1)**2+((-70560*cos(th0))-98400*tau2+196800*tau1)*cos(th1)+326928*cos(th0)-79200*tau2+248000*tau1)/1.6E+7)
    dd4 = rdetA * (-((((((720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*sin(th0)**2+(720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*cos(th0)**2)*sin(th1)**2+((720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*sin(th0)**2+(720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*cos(th0)**2)*cos(th1)**2)*sin(2*th1)+(((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*sin(th0)**2+((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*cos(th0)**2)*cos(th1)*sin(th1))*sin(th2)+((((-1320*dth2**2)+((-2640*dth1)-2640*dth0)*dth2-1320*dth1**2-2640*dth0*dth1-1320*dth0**2)*sin(th0)**2+((-1320*dth2**2)+((-2640*dth1)-2640*dth0)*dth2-1320*dth1**2-2640*dth0*dth1-1320*dth0**2)*cos(th0)**2)*sin(th1)**2+(((-600*dth2**2)+((-1200*dth1)-1200*dth0)*dth2-600*dth1**2-1200*dth0*dth1-600*dth0**2)*sin(th0)**2+((-600*dth2**2)+((-1200*dth1)-1200*dth0)*dth2-600*dth1**2-1200*dth0*dth1-600*dth0**2)*cos(th0)**2)*cos(th1)**2)*cos(th2)+(((-2340*dth0**2*sin(th0)**2)+22932*sin(th0)-2340*dth0**2*cos(th0)**2)*sin(th1)-22932*cos(th0)*cos(th1)-3600*tau2+3600*tau1)*sin(2*th1)+(((-4290*dth1**2)-8580*dth0*dth1-4290*dth0**2)*sin(th0)**2+((-4290*dth1**2)-8580*dth0*dth1-4290*dth0**2)*cos(th0)**2)*sin(th1)**2+(58212*cos(th0)+13200*tau1)*sin(th1)+(((-1950*dth1**2)-3900*dth0*dth1-1950*dth0**2)*sin(th0)**2+((-1950*dth1**2)-3900*dth0*dth1-1950*dth0**2)*cos(th0)**2)*cos(th1)**2+((-3150*dth0**2*sin(th0)**2)+35280*sin(th0)-3150*dth0**2*cos(th0)**2)*cos(th1))*sin(2*th2)+((((((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*sin(th0)**2+((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*cos(th0)**2)*sin(th1)**2+(((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*sin(th0)**2+((-720*dth2**2)+((-1440*dth1)-1440*dth0)*dth2-720*dth1**2-1440*dth0*dth1-720*dth0**2)*cos(th0)**2)*cos(th1)**2)*cos(2*th1)+((600*dth2**2+(1200*dth1+1200*dth0)*dth2+600*dth1**2+1200*dth0*dth1+600*dth0**2)*sin(th0)**2+(600*dth2**2+(1200*dth1+1200*dth0)*dth2+600*dth1**2+1200*dth0*dth1+600*dth0**2)*cos(th0)**2)*sin(th1)**2+((1320*dth2**2+(2640*dth1+2640*dth0)*dth2+1320*dth1**2+2640*dth0*dth1+1320*dth0**2)*sin(th0)**2+(1320*dth2**2+(2640*dth1+2640*dth0)*dth2+1320*dth1**2+2640*dth0*dth1+1320*dth0**2)*cos(th0)**2)*cos(th1)**2)*sin(th2)+((720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*sin(th0)**2+(720*dth2**2+(1440*dth1+1440*dth0)*dth2+720*dth1**2+1440*dth0*dth1+720*dth0**2)*cos(th0)**2)*cos(th1)*sin(th1)*cos(th2)+((2340*dth0**2*sin(th0)**2-22932*sin(th0)+2340*dth0**2*cos(th0)**2)*sin(th1)+22932*cos(th0)*cos(th1)+3600*tau2-3600*tau1)*cos(2*th1)+(((2340*dth1**2+4680*dth0*dth1+2340*dth0**2)*sin(th0)**2+(2340*dth1**2+4680*dth0*dth1+2340*dth0**2)*cos(th0)**2)*cos(th1)-3150*dth0**2*sin(th0)**2+35280*sin(th0)-3150*dth0**2*cos(th0)**2)*sin(th1)+((-58212*cos(th0))-13200*tau1)*cos(th1))*cos(2*th2)+((((2340*dth2**2+(4680*dth1+4680*dth0)*dth2+4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*sin(th0)**2+(2340*dth2**2+(4680*dth1+4680*dth0)*dth2+4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*cos(th0)**2)*sin(th1)**2-22932*cos(th0)*sin(th1)+((2340*dth2**2+(4680*dth1+4680*dth0)*dth2+4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*sin(th0)**2+(2340*dth2**2+(4680*dth1+4680*dth0)*dth2+4680*dth1**2+9360*dth0*dth1+4680*dth0**2)*cos(th0)**2)*cos(th1)**2+(2340*dth0**2*sin(th0)**2-22932*sin(th0)+2340*dth0**2*cos(th0)**2)*cos(th1))*sin(2*th1)+(((-3780*dth2**2)+((-7560*dth1)-7560*dth0)*dth2-3780*dth1**2-7560*dth0*dth1-3780*dth0**2)*sin(th0)**2+((-3780*dth2**2)+((-7560*dth1)-7560*dth0)*dth2-3780*dth1**2-7560*dth0*dth1-3780*dth0**2)*cos(th0)**2)*cos(th1)*sin(th1))*sin(th2)**2+((((2340*dth0**2*sin(th0)**2-22932*sin(th0)+2340*dth0**2*cos(th0)**2)*sin(th1)+22932*cos(th0)*cos(th1))*sin(2*th1)+((((-2340*dth2**2)+((-4680*dth1)-4680*dth0)*dth2-4680*dth1**2-9360*dth0*dth1-4680*dth0**2)*sin(th0)**2+((-2340*dth2**2)+((-4680*dth1)-4680*dth0)*dth2-4680*dth1**2-9360*dth0*dth1-4680*dth0**2)*cos(th0)**2)*sin(th1)**2+22932*cos(th0)*sin(th1)+(((-2340*dth2**2)+((-4680*dth1)-4680*dth0)*dth2-4680*dth1**2-9360*dth0*dth1-4680*dth0**2)*sin(th0)**2+((-2340*dth2**2)+((-4680*dth1)-4680*dth0)*dth2-4680*dth1**2-9360*dth0*dth1-4680*dth0**2)*cos(th0)**2)*cos(th1)**2+((-2340*dth0**2*sin(th0)**2)+22932*sin(th0)-2340*dth0**2*cos(th0)**2)*cos(th1))*cos(2*th1)+((1860*dth2**2+(3720*dth1+3720*dth0)*dth2+11400*dth1**2+22800*dth0*dth1+11400*dth0**2)*sin(th0)**2+(1860*dth2**2+(3720*dth1+3720*dth0)*dth2+11400*dth1**2+22800*dth0*dth1+11400*dth0**2)*cos(th0)**2)*sin(th1)**2-93492*cos(th0)*sin(th1)+((4740*dth2**2+(9480*dth1+9480*dth0)*dth2+14280*dth1**2+28560*dth0*dth1+14280*dth0**2)*sin(th0)**2+(4740*dth2**2+(9480*dth1+9480*dth0)*dth2+14280*dth1**2+28560*dth0*dth1+14280*dth0**2)*cos(th0)**2)*cos(th1)**2+(9540*dth0**2*sin(th0)**2-93492*sin(th0)+9540*dth0**2*cos(th0)**2)*cos(th1))*cos(th2)+(((-7605*dth0**2*sin(th0)**2)+74529*sin(th0)-7605*dth0**2*cos(th0)**2)*sin(th1)-74529*cos(th0)*cos(th1)-23400*tau2+11700*tau1)*sin(2*th1)+((7605*dth1**2+15210*dth0*dth1+7605*dth0**2)*sin(th0)**2+(7605*dth1**2+15210*dth0*dth1+7605*dth0**2)*cos(th0)**2)*sin(th1)**4-74529*cos(th0)*sin(th1)**3+((7605*dth0**2*sin(th0)**2-74529*sin(th0)+7605*dth0**2*cos(th0)**2)*cos(th1)+(4620*dth2**2+(9240*dth1+9240*dth0)*dth2+3240*dth1**2+6480*dth0*dth1+3240*dth0**2)*sin(th0)**2+(4620*dth2**2+(9240*dth1+9240*dth0)*dth2+3240*dth1**2+6480*dth0*dth1+3240*dth0**2)*cos(th0)**2)*sin(th1)**2+(74529*cos(th0)*cos(th1)**2+74529*cos(th0)+49800*tau1)*sin(th1)+(((-7605*dth1**2)-15210*dth0*dth1-7605*dth0**2)*sin(th0)**2+((-7605*dth1**2)-15210*dth0*dth1-7605*dth0**2)*cos(th0)**2)*cos(th1)**4+((-7605*dth0**2*sin(th0)**2)+74529*sin(th0)-7605*dth0**2*cos(th0)**2)*cos(th1)**3+((3000*dth2**2+(6000*dth1+6000*dth0)*dth2+13905*dth1**2+27810*dth0*dth1+13905*dth0**2)*sin(th0)**2+(3000*dth2**2+(6000*dth1+6000*dth0)*dth2+13905*dth1**2+27810*dth0*dth1+13905*dth0**2)*cos(th0)**2)*cos(th1)**2+(8505*dth0**2*sin(th0)**2-74529*sin(th0)+8505*dth0**2*cos(th0)**2)*cos(th1))*sin(th2)+((((-2340*dth0**2*sin(th0)**2)+22932*sin(th0)-2340*dth0**2*cos(th0)**2)*sin(th1)-22932*cos(th0)*cos(th1))*cos(2*th1)+((((-900*dth2**2)+((-1800*dth1)-1800*dth0)*dth2-900*dth1**2-1800*dth0*dth1-900*dth0**2)*sin(th0)**2+((-900*dth2**2)+((-1800*dth1)-1800*dth0)*dth2-900*dth1**2-1800*dth0*dth1-900*dth0**2)*cos(th0)**2)*cos(th1)+9540*dth0**2*sin(th0)**2-93492*sin(th0)+9540*dth0**2*cos(th0)**2)*sin(th1)+93492*cos(th0)*cos(th1))*cos(th2)**2+(((7605*dth0**2*sin(th0)**2-74529*sin(th0)+7605*dth0**2*cos(th0)**2)*sin(th1)+74529*cos(th0)*cos(th1)+23400*tau2-11700*tau1)*cos(2*th1)+(7605*dth0**2*sin(th0)**2-74529*sin(th0)+7605*dth0**2*cos(th0)**2)*sin(th1)**3+74529*cos(th0)*cos(th1)*sin(th1)**2+(((-7605*dth0**2*sin(th0)**2)+74529*sin(th0)-7605*dth0**2*cos(th0)**2)*cos(th1)**2+(((-1620*dth2**2)+((-3240*dth1)-3240*dth0)*dth2-4545*dth1**2-9090*dth0*dth1-4545*dth0**2)*sin(th0)**2+((-1620*dth2**2)+((-3240*dth1)-3240*dth0)*dth2-4545*dth1**2-9090*dth0*dth1-4545*dth0**2)*cos(th0)**2)*cos(th1)-2025*dth0**2*sin(th0)**2-2025*dth0**2*cos(th0)**2)*sin(th1)-74529*cos(th0)*cos(th1)**3+36000*tau1*cos(th1)-95400*tau2+47700*tau1)*cos(th2)-38025*tau2*sin(th1)**2+((((-5265*dth1**2)-10530*dth0*dth1-5265*dth0**2)*sin(th0)**2+((-5265*dth1**2)-10530*dth0*dth1-5265*dth0**2)*cos(th0)**2)*cos(th1)-8415*dth0**2*sin(th0)**2+58212*sin(th0)-8415*dth0**2*cos(th0)**2)*sin(th1)+38025*tau2*cos(th1)**2+(49200*tau1-35280*cos(th0))*cos(th1)-113625*tau2+39600*tau1)/8.0E+6)

    ds = np.zeros_like(s)
    ds[IDX_x0] = s[IDX_dx]
    ds[IDX_y0] = s[IDX_dy]
    ds[IDX_th0] = s[IDX_dth0]
    ds[IDX_th1] = s[IDX_dth1]
    ds[IDX_th2] = s[IDX_dth2]
    ds[IDX_dx]   = dd0
    ds[IDX_dy]   = dd1
    ds[IDX_dth0] = dd2
    ds[IDX_dth1] = dd3
    ds[IDX_dth2] = dd4

    return ds

def f_ground_3mass(t, s, u, params={}):

    th0 = s[IDX_th0]
    th1 = s[IDX_th1]
    th2 = s[IDX_th2]
    dth0 = s[IDX_dth0]
    dth1 = s[IDX_dth1]
    dth2 = s[IDX_dth2]
    tau0 = 0
    tau1 = u[0]
    tau2 = u[1]

    detA = (40*cos(2*th2+2*th1)-104*cos(2*th2)-130*cos(2*th1)+209)/1.6E+4
    assert detA > epsilon, detA
    rdetA = 1.0 / detA
    ddth0 = rdetA * ((((160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*cos(th1+th0)*sin(th2+th1+th0)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*sin(th1+th0)*cos(th2+th1+th0)-520*dth0**2*cos(th0)*sin(th1+th0)+(520*dth0**2*sin(th0)-5096)*cos(th1+th0)-800*tau2+800*tau1)*cos(2*th2+th1)+(((320*dth1**2+640*dth0*dth1+320*dth0**2)*cos(th1+th0)+320*dth0**2*cos(th0))*cos(th2+th1)+(((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*cos(th1+th0)-520*dth0**2*cos(th0))*cos(th2-th1)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*cos(th0)*cos(2*th2)+((-360*dth2**2)+((-720*dth1)-720*dth0)*dth2-360*dth1**2-720*dth0*dth1-360*dth0**2)*cos(th1)*cos(th1+th0)+(260*dth2**2+(520*dth1+520*dth0)*dth2+260*dth1**2+520*dth0*dth1+260*dth0**2)*cos(th0))*sin(th2+th1+th0)+((((-320*dth1**2)-640*dth0*dth1-320*dth0**2)*sin(th1+th0)-320*dth0**2*sin(th0)+3136)*cos(th2+th1)+((520*dth1**2+1040*dth0*dth1+520*dth0**2)*sin(th1+th0)+520*dth0**2*sin(th0)-5096)*cos(th2-th1)+(160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*sin(th0)*cos(2*th2)+(360*dth2**2+(720*dth1+720*dth0)*dth2+360*dth1**2+720*dth0*dth1+360*dth0**2)*cos(th1)*sin(th1+th0)+((-260*dth2**2)+((-520*dth1)-520*dth0)*dth2-260*dth1**2-520*dth0*dth1-260*dth0**2)*sin(th0))*cos(th2+th1+th0)-1600*tau2*cos(th2+th1)+2600*tau2*cos(th2-th1)+(((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*cos(th0)*sin(th1+th0)+(520*dth1**2+1040*dth0*dth1+520*dth0**2)*sin(th0)*cos(th1+th0)+8232*cos(th0)+800*tau1)*cos(2*th2)+(1170*dth0**2*cos(th0)*cos(th1)+(845*dth1**2+1690*dth0*dth1+845*dth0**2)*cos(th0))*sin(th1+th0)+((11466-1170*dth0**2*sin(th0))*cos(th1)+((-845*dth1**2)-1690*dth0*dth1-845*dth0**2)*sin(th0))*cos(th1+th0)+(1800*tau2-1800*tau1)*cos(th1)-13377*cos(th0)-1300*tau1)/4.0E+4)
    ddth1 = rdetA * (-(((160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*cos(th1+th0)*sin(th2+th1+th0)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*sin(th1+th0)*cos(th2+th1+th0)-520*dth0**2*cos(th0)*sin(th1+th0)+(520*dth0**2*sin(th0)-5096)*cos(th1+th0)-800*tau2+800*tau1)*cos(2*th2+2*th1)+(((160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*cos(th1+th0)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*cos(th0))*sin(th2+th1+th0)+(((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*sin(th1+th0)+(160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*sin(th0))*cos(th2+th1+th0)+((-520*dth1**2)-1040*dth0*dth1-1040*dth0**2)*cos(th0)*sin(th1+th0)+((520*dth1**2+1040*dth0*dth1+1040*dth0**2)*sin(th0)-5096)*cos(th1+th0)+8232*cos(th0)-800*tau2+1600*tau1)*cos(2*th2+th1)+(((520*dth1**2+1040*dth0*dth1+520*dth0**2)*cos(th1+th0)+520*dth0**2*cos(th0))*sin(th2+th1+th0)+(((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*sin(th1+th0)-520*dth0**2*sin(th0)+5096)*cos(th2+th1+th0)-2600*tau2)*cos(th2+2*th1)+(((320*dth1**2+640*dth0*dth1+320*dth0**2)*cos(th1+th0)+320*dth0**2*cos(th0))*cos(th2+th1)+(((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*cos(th1+th0)-520*dth0**2*cos(th0))*cos(th2-th1)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*cos(th0)*cos(2*th2)+(((-1040*dth1**2)-2080*dth0*dth1-1040*dth0**2)*cos(th1+th0)-1040*dth0**2*cos(th0))*cos(th2)+(((-360*dth2**2)+((-720*dth1)-720*dth0)*dth2-360*dth1**2-720*dth0*dth1-360*dth0**2)*cos(th1)-620*dth2**2+((-1240*dth1)-1240*dth0)*dth2-620*dth1**2-1240*dth0*dth1-620*dth0**2)*cos(th1+th0)+(360*dth2**2+(720*dth1+720*dth0)*dth2+360*dth1**2+720*dth0*dth1+360*dth0**2)*cos(th0)*cos(th1)+(260*dth2**2+(520*dth1+520*dth0)*dth2+260*dth1**2+520*dth0*dth1+260*dth0**2)*cos(th0))*sin(th2+th1+th0)+((((-320*dth1**2)-640*dth0*dth1-320*dth0**2)*sin(th1+th0)-320*dth0**2*sin(th0)+3136)*cos(th2+th1)+((520*dth1**2+1040*dth0*dth1+520*dth0**2)*sin(th1+th0)+520*dth0**2*sin(th0)-5096)*cos(th2-th1)+(160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*sin(th0)*cos(2*th2)+((1040*dth1**2+2080*dth0*dth1+1040*dth0**2)*sin(th1+th0)+1040*dth0**2*sin(th0)-10192)*cos(th2)+((360*dth2**2+(720*dth1+720*dth0)*dth2+360*dth1**2+720*dth0*dth1+360*dth0**2)*cos(th1)+620*dth2**2+(1240*dth1+1240*dth0)*dth2+620*dth1**2+1240*dth0*dth1+620*dth0**2)*sin(th1+th0)+((-360*dth2**2)+((-720*dth1)-720*dth0)*dth2-360*dth1**2-720*dth0*dth1-360*dth0**2)*sin(th0)*cos(th1)+((-260*dth2**2)+((-520*dth1)-520*dth0)*dth2-260*dth1**2-520*dth0*dth1-260*dth0**2)*sin(th0))*cos(th2+th1+th0)-1600*tau2*cos(th2+th1)+2600*tau2*cos(th2-th1)+(((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*cos(th0)*sin(th1+th0)+(520*dth1**2+1040*dth0*dth1+520*dth0**2)*sin(th0)*cos(th1+th0)+8232*cos(th0)+800*tau1)*cos(2*th2)+5200*tau2*cos(th2)+((1170*dth1**2+2340*dth0*dth1+2340*dth0**2)*cos(th0)*cos(th1)+(845*dth1**2+1690*dth0*dth1+2860*dth0**2)*cos(th0))*sin(th1+th0)+((((-1170*dth1**2)-2340*dth0*dth1-2340*dth0**2)*sin(th0)+11466)*cos(th1)+((-845*dth1**2)-1690*dth0*dth1-2860*dth0**2)*sin(th0)+19747)*cos(th1+th0)+((-18522*cos(th0))+1800*tau2-3600*tau1)*cos(th1)-13377*cos(th0)+3100*tau2-4400*tau1)/4.0E+4)
    ddth2 = rdetA * ((((160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*cos(th1+th0)*sin(th2+th1+th0)+((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*sin(th1+th0)*cos(th2+th1+th0)-520*dth0**2*cos(th0)*sin(th1+th0)+(520*dth0**2*sin(th0)-5096)*cos(th1+th0)-800*tau2+800*tau1)*cos(2*th2+2*th1)+(((-160*dth2**2)+((-320*dth1)-320*dth0)*dth2-160*dth1**2-320*dth0*dth1-160*dth0**2)*cos(th0)*sin(th2+th1+th0)+(160*dth2**2+(320*dth1+320*dth0)*dth2+160*dth1**2+320*dth0*dth1+160*dth0**2)*sin(th0)*cos(th2+th1+th0)+((-520*dth1**2)-1040*dth0*dth1-520*dth0**2)*cos(th0)*sin(th1+th0)+(520*dth1**2+1040*dth0*dth1+520*dth0**2)*sin(th0)*cos(th1+th0)+8232*cos(th0)+800*tau1)*cos(2*th2+th1)+(((520*dth2**2+(1040*dth1+1040*dth0)*dth2+1040*dth1**2+2080*dth0*dth1+1040*dth0**2)*cos(th1+th0)+520*dth0**2*cos(th0))*sin(th2+th1+th0)+(((-520*dth2**2)+((-1040*dth1)-1040*dth0)*dth2-1040*dth1**2-2080*dth0*dth1-1040*dth0**2)*sin(th1+th0)-520*dth0**2*sin(th0)+5096)*cos(th2+th1+th0)-1690*dth0**2*cos(th0)*sin(th1+th0)+(1690*dth0**2*sin(th0)-16562)*cos(th1+th0)-5200*tau2+2600*tau1)*cos(th2+2*th1)+(((-320*dth2**2)+((-640*dth1)-640*dth0)*dth2-320*dth1**2-640*dth0*dth1-320*dth0**2)*cos(th0)*cos(th2+th1)+(520*dth2**2+(1040*dth1+1040*dth0)*dth2+520*dth1**2+1040*dth0*dth1+520*dth0**2)*cos(th0)*cos(th2-th1)+(((-1040*dth2**2)+((-2080*dth1)-2080*dth0)*dth2-2080*dth1**2-4160*dth0*dth1-2080*dth0**2)*cos(th1+th0)-1040*dth0**2*cos(th0))*cos(th2)+((1690*dth1**2+3380*dth0*dth1+1690*dth0**2)*cos(2*th1)-620*dth2**2+((-1240*dth1)-1240*dth0)*dth2-3025*dth1**2-6050*dth0*dth1-3025*dth0**2)*cos(th1+th0)+1690*dth0**2*cos(th0)*cos(2*th1)+(360*dth2**2+(720*dth1+720*dth0)*dth2+360*dth1**2+720*dth0*dth1+360*dth0**2)*cos(th0)*cos(th1)-2405*dth0**2*cos(th0))*sin(th2+th1+th0)+((320*dth2**2+(640*dth1+640*dth0)*dth2+320*dth1**2+640*dth0*dth1+320*dth0**2)*sin(th0)*cos(th2+th1)+((-520*dth2**2)+((-1040*dth1)-1040*dth0)*dth2-520*dth1**2-1040*dth0*dth1-520*dth0**2)*sin(th0)*cos(th2-th1)+((1040*dth2**2+(2080*dth1+2080*dth0)*dth2+2080*dth1**2+4160*dth0*dth1+2080*dth0**2)*sin(th1+th0)+1040*dth0**2*sin(th0)-10192)*cos(th2)+(((-1690*dth1**2)-3380*dth0*dth1-1690*dth0**2)*cos(2*th1)+620*dth2**2+(1240*dth1+1240*dth0)*dth2+3025*dth1**2+6050*dth0*dth1+3025*dth0**2)*sin(th1+th0)+(16562-1690*dth0**2*sin(th0))*cos(2*th1)+((-360*dth2**2)+((-720*dth1)-720*dth0)*dth2-360*dth1**2-720*dth0*dth1-360*dth0**2)*sin(th0)*cos(th1)+2405*dth0**2*sin(th0)-23569)*cos(th2+th1+th0)+(((-1040*dth1**2)-2080*dth0*dth1-1040*dth0**2)*cos(th0)*sin(th1+th0)+(1040*dth1**2+2080*dth0*dth1+1040*dth0**2)*sin(th0)*cos(th1+th0)+16464*cos(th0)+1600*tau1)*cos(th2+th1)+((1690*dth1**2+3380*dth0*dth1+1690*dth0**2)*cos(th0)*sin(th1+th0)+((-1690*dth1**2)-3380*dth0*dth1-1690*dth0**2)*sin(th0)*cos(th1+th0)-26754*cos(th0)-2600*tau1)*cos(th2-th1)+(3380*dth0**2*cos(th0)*sin(th1+th0)+(33124-3380*dth0**2*sin(th0))*cos(th1+th0)+10400*tau2-5200*tau1)*cos(th2)+((1170*dth1**2+2340*dth0*dth1+1170*dth0**2)*cos(th0)*cos(th1)+2015*dth0**2*cos(th0))*sin(th1+th0)+(((-1170*dth1**2)-2340*dth0*dth1-1170*dth0**2)*sin(th0)*cos(th1)-2015*dth0**2*sin(th0)+19747)*cos(th1+th0)-8450*tau2*cos(2*th1)+((-18522*cos(th0))-1800*tau1)*cos(th1)+15125*tau2-3100*tau1)/4.0E+4)

    ds = np.zeros_like(s)
    ds[IDX_x0] = 0
    ds[IDX_y0] = 0
    ds[IDX_dx] = 0
    ds[IDX_dy] = 0
    ds[IDX_th0] = dth0
    ds[IDX_th1] = dth1
    ds[IDX_th2] = dth2
    ds[IDX_dth0] = ddth0
    ds[IDX_dth1] = ddth1
    ds[IDX_dth2] = ddth2

    return ds


# compensate P0(toe) trans velocity change to 0 of collision with rotation change with f_air
# only fx0,fy0 works. no torq work for each joint.
# A[2:] [ddx0, ddy0, ddth0, ddth1, ddth2] = 0
#
def collision_impulse_3mass(s, u):
    th0 = s[IDX_th0]
    th1 = s[IDX_th1]
    th2 = s[IDX_th2]
    ddx0 = s[IDX_dx]
    ddy0 = s[IDX_dy]
    detA = (40*cos(2*th2+2*th1)-104*cos(2*th2)-130*cos(2*th1)+209)/1.6E+4
    assert detA > epsilon, detA
    rdetA = 1.0 / detA

    ddth0 = rdetA * ((((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)))/20)*(8*cos(2*th2+th1)+8*cos(2*th2)-18*cos(th1)-13))/400-(((ddy0*cos(th2+th1+th0))/5-(ddx0*sin(th2+th1+th0))/5)*(4*cos(2*th2+th1)+8*cos(th2+th1)-13*cos(th2-th1)-9*cos(th1)))/200-((8*cos(2*th2)-13)*((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)+21*cos(th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)+21*sin(th0)))/20))/400)
    ddth1 = rdetA * ((((ddy0*cos(th2+th1+th0))/5-(ddx0*sin(th2+th1+th0))/5)*(8*cos(2*th2+2*th1)+8*cos(2*th2+th1)+26*cos(th2+2*th1)+16*cos(th2+th1)-26*cos(th2-th1)-52*cos(th2)-18*cos(th1)-31))/400-(((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)))/20)*(2*cos(2*th2+2*th1)+4*cos(2*th2+th1)+2*cos(2*th2)-9*cos(th1)-11))/100+(((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)+21*cos(th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)+21*sin(th0)))/20)*(8*cos(2*th2+th1)+8*cos(2*th2)-18*cos(th1)-13))/400)
    ddth2 = rdetA * ((-(((ddy0*cos(th2+th1+th0))/5-(ddx0*sin(th2+th1+th0))/5)*(32*cos(2*th2+2*th1)+208*cos(th2+2*th1)-416*cos(th2)+338*cos(2*th1)-605))/1600)+(((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)))/20)*(8*cos(2*th2+2*th1)+8*cos(2*th2+th1)+26*cos(th2+2*th1)+16*cos(th2+th1)-26*cos(th2-th1)-52*cos(th2)-18*cos(th1)-31))/400-(((ddy0*(4*cos(th2+th1+th0)+13*cos(th1+th0)+21*cos(th0)))/20-(ddx0*(4*sin(th2+th1+th0)+13*sin(th1+th0)+21*sin(th0)))/20)*(4*cos(2*th2+th1)+8*cos(th2+th1)-13*cos(th2-th1)-9*cos(th1)))/200)

    new_s = s.copy() # each position does not change
    new_s[IDX_dx]   = 0
    new_s[IDX_dy]   = 0
    new_s[IDX_dth0] = s[IDX_dth0] + ddth0
    new_s[IDX_dth1] = s[IDX_dth1] + ddth1
    new_s[IDX_dth2] = s[IDX_dth2] + ddth2

    return new_s

def step(t, s, u, dt):
    return step_impl(t, s, u, dt, f_air_3mass, f_ground_3mass, collision_impulse_3mass)

def energyU(s):
    p0, p1, p2, p3 = node_pos(s)
    c0 = (p0 + p1)/2
    c1 = (p1 + p2)/2
    c2 = (p2 + p3)/2
    return c0[1] * m0 * g + c1[1] * m1 * g + c2[1] * m2 * g

def energyT(s):
    v0, v1, v2, v3 = node_vel(s)
    c0 = (v0 + v1)/2
    c1 = (v1 + v2)/2
    c2 = (v2 + v3)/2
    return m0 * c0 @ c0 / 2 + m1 * c1 @ c1 / 2 + m2 * c2 @ c2 / 2

def energy(s):
    return energyU(s) + energyT(s)

